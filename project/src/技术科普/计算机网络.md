---
date: 2024-07-08
title: 计算机网络
category:
  - 网络
tag:
  - http
---

::: tip http2与http1区别?
:::

HTTP/2 是对 HTTP/1.x 协议的重大升级，旨在提高网络性能和效率。以下是 HTTP/2 相对于 HTTP/1 的一些关键区别和改进：

### 1. 协议基础

- **HTTP/1.x**: 基于纯文本的协议，使用新行符分隔的文本消息进行通信。
- **HTTP/2**: 基于二进制的协议，使用二进制帧传输数据，更高效地解析和传输数据。

### 2. 连接管理

- **HTTP/1.x**:
  - 每个请求/响应对通常需要一个单独的TCP连接（HTTP/1.0）。
  - HTTP/1.1 引入了连接保持（Keep-Alive），允许在同一个TCP连接上复用多个请求，但在同一时刻只能处理一个请求（串行化处理）。
  
- **HTTP/2**:
  - 单个TCP连接上可以处理多个并发的请求/响应对。
  - 使用流的概念，每个请求/响应对在一个单独的流中，流之间可以独立并行处理。

### 3. 多路复用

- **HTTP/1.x**: 在一个连接上，只有一个请求/响应对可以被处理（头部阻塞问题），需要等待当前请求完成后，才能开始下一个请求。
- **HTTP/2**: 允许多个请求/响应对在同一连接上的多个流中并发传输，不同的流可以独立处理，不会相互阻塞。

### 4. 头部压缩

- **HTTP/1.x**: HTTP头部是以纯文本格式传输的，每个请求都需要发送完整的头部信息，导致冗余和带宽浪费。
- **HTTP/2**: 使用 HPACK 算法对头部进行压缩，减少了传输数据量。头部信息仅在第一次请求时完整传输，后续请求只需发送差异部分。

### 5. 服务器推送

- **HTTP/1.x**: 客户端必须明确请求每个资源，服务器只能响应客户端的请求。
- **HTTP/2**: 支持服务器推送功能，服务器可以在客户端请求之前主动发送资源，这有助于减少延迟和提升性能。例如，当客户端请求HTML页面时，服务器可以主动推送相关的CSS和JavaScript文件。

### 6. 优先级和流控制

- **HTTP/1.x**: 没有内建的优先级控制机制，所有请求被平等对待。
- **HTTP/2**: 支持流的优先级，客户端可以指定不同流的优先级，允许更重要的请求先行处理。同时，HTTP/2 提供流量控制机制，确保没有流会独占带宽。

### 7. 加密和安全

- **HTTP/1.x**: 加密是可选的（通过HTTP或HTTPS），但非加密的HTTP请求仍然普遍存在。
- **HTTP/2**: 大多数实现强制要求使用加密（通过HTTPS），尽管协议本身不强制这一点。现代浏览器和服务器在实际应用中通常要求 HTTP/2 使用 TLS。

### 8. 协议扩展性

- **HTTP/1.x**: 由于是文本协议，扩展和添加新功能变得复杂。
- **HTTP/2**: 作为二进制协议，HTTP/2 更容易扩展，添加新功能可以通过新帧类型和更复杂的协议操作来实现，而不影响现有的功能。

### 9. 性能改进

- **HTTP/1.x**: 多个小的请求可能会因为串行化处理导致较高的延迟和低效的带宽利用。
- **HTTP/2**: 通过多路复用、头部压缩和服务器推送等功能，HTTP/2 显著降低了延迟，改善了带宽利用，提升了整体性能。

### 总结

| 特性          | HTTP/1.x                         | HTTP/2                           |
|--------------|---------------------------------|---------------------------------|
| 协议类型      | 基于纯文本                        | 基于二进制                      |
| 连接管理      | 每个请求通常需要一个TCP连接        | 单个连接处理多个并发请求        |
| 多路复用      | 不支持（有头部阻塞问题）           | 支持                           |
| 头部压缩      | 不支持                           | 使用HPACK算法进行压缩           |
| 服务器推送    | 不支持                           | 支持                           |
| 优先级和流控制 | 不支持                           | 支持                           |
| 加密和安全    | 可选（但非强制）                  | 大多数实现要求加密（HTTPS）    |
| 协议扩展性    | 扩展复杂                         | 更容易扩展                     |
| 性能          | 受限于串行化处理和头部阻塞         | 显著提升（多路复用、压缩、推送）|

HTTP/2 带来了显著的改进和优化，使得网络应用能够更高效地传输数据，提升了用户体验和网络性能。



## 查看系统中已有的veth设备对或确认已创建的veth设备对，可以使用以下几种方法：

### 使用 `ip` 命令
`ip` 命令是查看和管理网络设备的主要工具：

1. **列出所有网络接口**：
   ```sh
   ip link show
   ```
   该命令会列出系统中所有的网络接口，包括veth设备对。

2. **过滤veth设备**：
   ```sh
   ip link show | grep veth
   ```
   通过`grep`过滤出veth设备。

### 使用 `ifconfig` 命令
`ifconfig`命令也可以用于查看网络接口：
```sh
ifconfig
```
同样，可以使用`grep`过滤出veth设备：
```sh
ifconfig | grep veth
```

### 查看具体veth设备对的详细信息
可以使用以下命令查看某个veth设备对的详细信息：
```sh
ip link show veth0
```

### 示例
假设创建了一个veth设备对：
```sh
ip link add veth0 type veth peer name veth1
```
然后，可以使用以下命令查看：
```sh
ip link show | grep veth
```
输出可能类似于：
```
10: veth0@veth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
11: veth1@veth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
```
这表明`veth0`和`veth1`是一对互相连接的虚拟以太网设备。

### 检查命名空间中的veth设备
如果将veth设备移动到不同的命名空间，可以使用以下命令查看特定命名空间中的网络接口：
```sh
ip netns exec ns1 ip link show

ip netns exec ns1 ip link show
1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
28: veth1@if29: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000
    link/ether 52:7e:e0:b6:47:d2 brd ff:ff:ff:ff:ff:ff link-netnsid 0

ip netns exec ns1 ip a
1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
28: veth1@if29: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 52:7e:e0:b6:47:d2 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 192.168.1.2/24 scope global veth1
       valid_lft forever preferred_lft forever
    inet6 fe80::507e:e0ff:feb6:47d2/64 scope link
       valid_lft forever preferred_lft forever    
```
假设`veth1`被移动到命名空间`ns1`，可以在`ns1`命名空间中看到它。

通过这些命令，可以方便地查看和管理系统中的veth设备对。

